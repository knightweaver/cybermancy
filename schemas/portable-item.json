{
  "$id": "portable-item.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Cybermancy Portable Item Schema",
  "type": "object",
  "description": "Schema for portable Cybermancy/Daggerheart item definitions used outside Foundry (e.g. web exports).",
  "required": ["name", "type", "system"],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Display name of the item."
    },
    "type": {
      "type": "string",
      "enum": [
        "weapon",
        "armor",
        "consumable",
        "loot",
        "domain",
        "augment",
        "program",
        "gear"
      ],
      "description": "Item category or class."
    },
    "img": {
      "type": "string",
      "description": "Path or URL to an image or icon resource."
    },
    "meta": {
      "type": "object",
      "description": "Metadata for the export process.",
      "properties": {
        "source": {
          "type": "string",
          "enum": ["foundry", "web", "manual"],
          "description": "Origin of the data."
        },
        "class": {
          "type": ["string", "null"],
          "description": "Original Foundry document class (usually 'Item')."
        },
        "name": {
          "type": ["string", "null"],
          "description": "Redundant name copy for safety."
        },
        "exportedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of export."
        }
      },
      "additionalProperties": false
    },
    "system": {
      "type": "object",
      "description": "Game-system-specific data for Daggerheart/Cybermancy items.",
      "required": ["rarity", "tags"],
      "properties": {
        "rarity": {
          "type": "string",
          "enum": ["common", "uncommon", "rare", "legendary", "prototype", "unique"],
          "description": "Item rarity tier."
        },
        "tags": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Gameplay or flavor tags."
        },
        "description": {
          "type": "string",
          "description": "Human-readable description or effect text (Markdown allowed)."
        },
        "damage": {
          "type": ["string", "null"],
          "pattern": "^[0-9]+d[0-9]+(\\+[0-9]+)?$",
          "description": "Damage formula, e.g. '1d8+2'."
        },
        "range": {
          "type": ["string", "null"],
          "description": "Effective range or distance in game terms."
        },
        "trait": {
          "type": ["string", "null"],
          "enum": ["strength", "dexterity", "intellect", "presence", "none"],
          "description": "Primary attribute governing the roll."
        },
        "burden": {
          "type": ["string", "null"],
          "enum": ["light", "medium", "heavy", "none"],
          "description": "Encumbrance or equip burden."
        },
        "feature": {
          "type": ["string", "null"],
          "description": "Special or unique mechanical feature."
        },
        "criticalEffect": {
          "type": ["string", "null"],
          "description": "Special narrative or mechanical effect on a critical success."
        }
      },
      "additionalProperties": true
    },
    "flags": {
      "type": "object",
      "description": "Optional cross-system flags, ignored in portable context.",
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
